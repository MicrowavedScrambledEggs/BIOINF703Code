---
title: "BIOINF703 Lab 1"
author: "Badi James"
date: "August 7, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(network)
library(sna)
source("networkLabHelper.R")
G <- readGraphFromFile("labNet.txt")
```

## Plotting G


```{r plottingG}
plot.network(G, mode = "circle", edge.col = rgb(red = 0, blue = 0, green = 0, alpha = 0.1))
```

## Plotting degree

```{r degree}
gNodeDegs <- degree(G, gmode = "graph")
hist(gNodeDegs, ylim = c(0,35), xlim = c(0,100), xlab = "Degree", main = "Degree distribution of G")

```

## Binomial (Simulating an Erdos-Renyi model for G)

```{r binomial}
gDegMean <- mean(gNodeDegs)
n <- length(gNodeDegs)
prob <- gDegMean / (n-1)
binomDegs <- rbinom(n, n-1, prob)
hist(binomDegs, ylim = c(0,35), xlim = c(0,100), xlab = "Degree", 
     main = "Degree distribution of ER network of same size and mean degree of G")

```

G has a broad range of degree values. Variance is high, so many degree values are not clustered around the mean.
As an ER network of the same size and mean degree has a narrower range of degree values clustered around the mean it is not a representative model of G. It is missing nodes of very low and very high degree, unlike G. 

## scale free degree

```{r scalefree}
k = 2:(n-1)
unnormDensGam1 <- k^(-1)
unnormDensGam2 <- k^(-2)
unnormDensGam3 <- k^(-3)

plot(k,unnormDensGam1, type= "l", ylab = "unnormalized density", col="red",
     main = "Power-law distribution with")
lines(k, unnormDensGam2, col="blue")
lines(k, unnormDensGam3, col="green")
legend("center", legend = c("Gamma = 1", "Gamma = 2", "Gamma = 3"), col= c("red", "blue", "green"), lty = c(1,1,1))
```

Scale free networks would be poor models for G as the high frequency of nodes with low degree is not characteristic of G. Out of the gamma values plotted above, a scale free network with gamma of 1 would be the best of the 3 scale free networks for modelling G as it has the higher frequency of nodes with higher degree. 

## Making 200 ER graphs

```{r 200ER Betweenness}
er200 <- sapply(rep(n, 200), function(x) list(sampleER(x, prob)))
er200Btwn <- sapply(er200, betweenness, gmode = "graph", cmode = "undirected")
er200MeanBtwn <- apply(er200Btwn, 2, mean)
gBetween <- betweenness(G, gmode = "graph", cmode = "undirected")
gMeanBtwn <- mean(gBetween)
hist(er200MeanBtwn)
abline(v = gMeanBtwn, col = "red")
```

```{r 200ER degree centrality}
er200DegCen <- sapply(er200, degree, gmode = "graph")
er200MeanDegCen <- apply(er200DegCen, 2, mean)
gDegCen <- degree(G, gmode = "graph")
gMeanDegCen <- mean(gDegCen)
hist(er200MeanDegCen)
abline(v = gMeanDegCen, col = "red")

```

```{r 200ER local clustering coefficient}
er200LCC <- sapply(er200, localclustering)
gLCC <- localclustering(G)
hist(er200LCC, xlim = c(0.4,0.9))
abline(v = gLCC, col = "red")
```


## Making 200 graphs sampled from the degree distribution of G

```{r 200dd Betweenness}
dd200 <- sapply(rep(1, 200), function(x) list(rgraphFromDegreeDist(G)))
dd200Btwn <- sapply(dd200, betweenness, gmode = "graph", cmode = "undirected")
dd200MeanBtwn <- apply(dd200Btwn, 2, mean)
hist(dd200MeanBtwn, xlim = c(31, 42))
abline(v = gMeanBtwn, col = "red")
```

```{r 200dd degree centrality}
dd200DegCen <- sapply(dd200, degree, gmode = "graph")
dd200MeanDegCen <- apply(dd200DegCen, 2, mean)
hist(dd200MeanDegCen)
abline(v = gMeanDegCen, col = "red")

```

```{r 200dd local clustering coefficient}
dd200LCC <- sapply(dd200, localclustering)
hist(dd200LCC, xlim = c(0.5,0.85))
abline(v = gLCC, col = "red")
```